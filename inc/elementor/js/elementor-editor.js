(()=>{"use strict";const e=["query_type","sort_by","sort_order","sort_days","terms","cat","offset","reviews_only","tags","post_ids","post_formats","taxonomy","tax_ids","post_type","exclude_tags","exclude_ids","exclude_current","query_id"];
/**
 * Elementor backend editor extra functionality.
 * 
 * @copyright 2023 ThemeSphere.
 */
jQuery((function(t){elementor.hooks.addAction("panel/open_editor/container",(function(t,n,i){var s=t.$el;n.get("settings")&&n.get("settings").on("change",(t=>{Object.keys(t.changed).some((t=>e.includes(t)))&&o(i.$el)})),s.length})),elementor.hooks.addAction("panel/open_editor/section",(function(n,i,s){var r=n.$el;i.get("settings")&&i.get("settings").on("change",(t=>{Object.keys(t.changed).some((t=>e.includes(t)))&&o(s.$el)})),r.length&&r.find('[data-setting="gutter"]').on("change",(function(){if("none"!=t(this).val()){var e=r.find('[data-setting="gap"]');e.length&&e.val("no").trigger("change")}}))})),elementor.hooks.addAction("panel/open_editor/column",((e,t,n)=>{if(!e.$el)return;const o=n._parent;o&&o.getPreviousColumn&&t.get("settings").on("change:is_sidebar",((e,t)=>{const i=o.getPreviousColumn(n)||o.getNextColumn(n);if(!i)return;const s=i.model.get("settings");e!==s&&(t?((s.get("_inline_size")||e.get("_inline_size"))&&(s.set("_inline_size",66.667),e.set("_inline_size",33.333),n.render(),i.render()),s.set("is_main","main-content").set("_inline_size_tablet",100),e.set("_inline_size_tablet",100)):s.set("is_main",""))}))}));const n=e=>{const t=(e,n)=>{if(!n.elements)return;const o=n.elements;let i=n.elements.get(e);return i||(o.models?(o.models.find((n=>!!n.attributes&&(i=t(e,n.attributes),i))),i):void 0)};return t(e,elementor)},o=(e,o)=>{t(e).find("[data-model-cid]").each(((e,i)=>{const s=t(i).data("model-cid");if(o&&o===s)return;const r=n(s);"section"===r.getSetting("query_type")&&r.renderRemoteServer()}))},i=o=>{const i=o.options.model.get("settings");if(!i||"section"!==i.get("query_type"))return;const r=s(o),a=n(t(r).data("model-cid"));if(!a||!a.get("settings"))return;let l=0;r.find("[data-model-cid]").each(((e,o)=>{const i=t(o).data("model-cid"),s=n(i),r=s.get("settings");r&&"section"===r.get("query_type")&&(r.set({skip_posts:l},{silent:!0}),l+=s.getSetting("posts")||0)}));let d=a.get("settings"),c={};if(d&&d.toJSON){d=d.toJSON();for(let t in d)e.includes(t)&&(c[t]=d[t])}i.set({section_data:c},{silent:!0})},s=e=>{const o=t(e.el).parents("[data-element_type=container]");if(!o.length)return t(e.el).closest("[data-element_type=section]");let i;return o.each(((e,o)=>{const s=n(t(o).data("model-cid"));return!s||!s.get("settings")||("none"===s.getSetting("query_type")||(i=t(o),!1))})),i||!1};elementor.hooks.addFilter("elements/base/behaviors",((t,n)=>{if("widget"!==n.options.model.get("elType"))return t;if(-1===n.options.model.get("widgetType").indexOf("smartmag"))return t;(t=>{const n=t.options.model;if(!n||!n.on)return;const r=n.get("settings");r&&r.on("change",(i=>{Object.keys(i.changed).some((t=>e.includes(t)))&&o(s(t),n.cid)})),n.on("before:remote:render",(()=>i(t)));let a=!1;t.on("render",(()=>{if(a)return a=!1,!1;const e=Object.assign({},n.get("settings").get("section_data"));a=!0,i(t);const o=n.get("settings").get("section_data");o&&!_.isEqual(e,o)?n.renderRemoteServer():a=!1}))})(n);const r=e=>{var t=[];if(!e.model||!e.model.getSetting)return[];if(e.model.getSetting("_column_size"))t.push(e.model.getSetting("_column_size"));else if(e.model.getSetting("width")){const n=e.model.getSetting("width");n.unit&&"%"===n.unit&&n.size&&t.push(n.size)}return e._parent&&e.model&&(t=t.concat(r(e._parent))),t},a=e=>{const t=r(e);return t&&t.length?t.reduce(((e,t)=>t/100*e)):100};var l=n.onRender.bind(n);return n.onRender=function(){let e;if(l.apply(this,arguments),n.model.getSetting("container_width")){if(!n.model.attributes._parentWidth)return void(n.model.attributes._parentWidth=a(n));if(e=a(n),n.model.attributes._parentWidth===e)return}var t=e||a(n);if(n.model.attributes._parentWidth=t,t){let e=1;elementor.$previewContents.find(".main:not(.no-sidebar)").length&&(e=.666);let o=33;(t*=e)>90?o=100:t>60?o=66:t>40&&(o=50),n.model.setSetting("container_width",o)}},t}));const r=()=>{const e=elementor.documents.getCurrent(),t=e.container.settings.get("post_status");$e.internal("document/save/save",{status:t,document:e,onSuccess:()=>{elementor.reloadPreview()}})};elementor.settings.page.addChangeCallback("show_page_title",r),elementor.settings.page.addChangeCallback("layout_style",r),function(){let e=!1;const t=Object.assign(new(Object.getPrototypeOf($e.hooks.ui).constructor),{getCommand:()=>"document/elements/create",getId:()=>"bunyad-section-set-defaults",getContainerType:()=>"",run(t,n){setTimeout((()=>{if(e&&"section"===t.model.elType&&n.model){n.model.setSetting("gutter","default"),n.model.setSetting("gap","no");try{n.view.render()}catch(e){elementor.panel.currentView.$el.find("[data-setting=gap]").trigger("change")}setTimeout((()=>e=!1),1)}}),2)}});$e.hooks.registerUIAfter(t),elementor.on("preview:loaded",(()=>{elementor.$previewContents.on("click",".elementor-preset",(t=>{e=!0})),elementor.$previewContents.on("drop",(t=>{elementor.channels.panelElements.request("element:selected").model&&(e=!0)}))}))}(),function(){if(window.elementorPro)return;const e=t("#tmpl-elementor-panel-categories");e.text(e.text().replace('elementor-nerd-box"','" style="display: none;"')),Array.isArray(elementor.config.promotionWidgets)&&(elementor.config.promotionWidgets=[]),$e.commandsInternal.on("run:after",((e,t)=>{"panel/state-ready"===t&&elementor.getPanelView().getRegion("content").on("show",(()=>{elementor.getPanelView().$el.find(".elementor-panel-menu-item-site-editor").hide()}))}))}(),function(e){const t=elementor.modules.controls.BaseData.extend({applySavedValue(){elementor.modules.controls.BaseData.prototype.applySavedValue.apply(this,arguments);const t=this.ui.select,n=Object.assign({sortable:!0,multiple:!0,create:!1,ajax:!1,preload:!0},this.model.get("selectize_options")||{}),o=this.getControlValue(),i={create:n.create,items:o,plugins:[]};if(n.sortable&&i.plugins.push("drag_drop"),n.multiple&&i.plugins.push("remove_button"),n.ajax&&(i.preload=n.preload,i.load=(t,o,i)=>{window.bunyadAjaxCache||(window.bunyadAjaxCache={});const s=e=>(e=wpApiSettings.root.includes("?")?e.replace("?","&"):e,wpApiSettings.root+wpApiSettings.versionString+e);let r=n.url||"";if(n.endpoint&&(r=s(n.endpoint),r=r.replace("{query}",encodeURIComponent(t))),i&&(r=s(n.endpoint_saved),r=r.replace("{ids}",t)),r in window.bunyadAjaxCache)return o(window.bunyadAjaxCache[r]);e.ajax({url:r,type:"GET",dataType:"json",beforeSend:e=>e.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce),error:()=>o(),success:e=>{const t=[];e.forEach((e=>{e.id&&t.push({text:e.name,value:e.id})})),window.bunyadAjaxCache[r]=t,o(t)}})},o)){let e=o;Array.isArray(o)&&(e=o.filter((e=>parseInt(e))).join(","));const n=()=>{const n=t[0].selectize;i.load(e,(e=>{e&&(e.forEach((e=>n.addOption(e))),n.clear(!0),n.setValue(o,!0))}),!0)};e&&(i.onInitialize=n)}if(t.selectize(i),n.create){const e=t[0].selectize;if(Array.isArray(o)){for(const t of o)parseInt(t)||e.addOption({text:t,value:t});e.setValue(o,!0)}}}});elementor.addControlView("bunyad-selectize",t)}(t)}))})();